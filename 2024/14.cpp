#pragma GCC optimize ("O3")
#include <ranges>
#include <vector>
#include <string>
#include <sstream>
#include<unordered_map>
#include <set>
#include <map>
#include <iostream>
#include <algorithm>


using namespace std;
using ll = long long;
const ll MOD = 1e9+7;


vector<ll> split(const string&line, char delim){
    stringstream ss(line);
    string s;
    vector<ll> ans;
    while(getline(ss,s,delim)){
        if(!s.empty()) ans.push_back(stoll(s));
    }
    return ans;
}

struct Robot {
    ll x, y, dx, dy;
};

Robot Parse(const string& line){
    stringstream ss(line);
    string s;
    vector<ll> nums;
    while(ss >> s){
        for(auto x:split(s.substr(2),',')){
            nums.push_back(x);
        }
    }
    cout << nums[0] << ' ' << nums[1] << ' ' << nums[2] << ' ' << nums[3] << endl;
    return Robot{nums[0], nums[1], nums[2], nums[3]};
}

//int X = 11;
//int Y = 7;
int X = 101;
int Y = 103;
// binary searching the starting point to manually inspect out of the 10k+
int start = 7500;

map<vector<string>, int> m;

bool Print(const vector<Robot>& v,int i){
    vector<string> ans(Y, string(X,'.'));
    for(auto&r:v){
        ans[r.y][r.x] = 'X';
    }
    if(i>start){
    cout << i << ":\n";
    for(auto&x:ans) cout << x << endl;
    }
    auto [it, inserted] = m.insert({ans,i});
    return inserted;
}



int main(){
//    ios_base::sync_with_stdio(false);
//    cin.tie(NULL);
    string line;
    vector<Robot> v;
    while(getline(cin,line)){
        if(line.empty()) break;
        v.push_back(Parse(line));
    }
    for(int i=1; i<1000000; ++i){
        for(auto&r:v){
            r.x += r.dx;
            r.y += r.dy;
            r.x %= X;
            r.y %= Y;
            if(r.x<0) r.x += X;
            if(r.y<0) r.y += Y;
//            cout << r.x << ' ' << r.y << endl;
        }
        cout << i << ": " <<endl;
        if(!Print(v,i)) return 0;
        if(i>start) cin.get();
    }

//    vector<int> ans(4,0);
//    for(auto&r:v){
//        if(r.x==X/2 || r.y==Y/2) continue;
//        int c = (r.x > X/2) + 2*(r.y > Y/2);
//        ans[c]++;
//    }
//    for(auto x:ans)cout<< x << ' '; cout << endl;
//    ll x = 1;
//    for(auto&y:ans) x *=y;
//    cout << x << endl;
}


/*
8087:
................................................................................X....................
.................................................X...................................................
..............................................X......................................................
................X.X............................X.....................................................
.................................................................................X...................
................................................................................................X....
..X..................................................................................................
.....X........................................................................................X......
.X...................................................................................................
.....................................................................................................
...........................................................X...........X........X....................
.........X..........................................X.........X......................................
..............................................X........X.............................................
.......................................X..........X..................................................
...................................................................................X.............X...
............................................................X........................................
.................X.......................X.............................X.............................
.............................X.......................................................................
.................................X...............................X.........................X.........
.........X........................X..........................................X.......................
.....................................................................................................
.............................X.......................................................................
.......X.............................X....X..........................................................
...X..............................................................X......................X...........
..........................X............................................X.............................
.......................................................................................X.............
..............................................X......................................................
.............X.......................................................................X...............
............X.................................X.....X.......................................X........
.....................................................................................................
................XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX......................................................
................X.............................X......................................................
................X.............................X.....X........................X.......................
................X.............................X.................X....................................
................X.............................X......................................................
................X..............X..............X......................................................
................X.............XXX.............X....X.........................................X.......
................X............XXXXX............X......................................................
................X...........XXXXXXX...........X......................................................
................X..........XXXXXXXXX..........X......................................................
X.....X.........X............XXXXX............X......................................................
................X...........XXXXXXX...........X......................................................
................X..........XXXXXXXXX..........X....................X...............................X.
................X.........XXXXXXXXXXX.........X........................................X.............
...X......X.....X........XXXXXXXXXXXXX........X..X...................................................
................X..........XXXXXXXXX..........X..............X.....................................X.
................X.........XXXXXXXXXXX.........X......................................................
................X........XXXXXXXXXXXXX........X............................................X.........
................X.......XXXXXXXXXXXXXXX.......X......................................................
..........X.....X......XXXXXXXXXXXXXXXXX......X......................................................
................X........XXXXXXXXXXXXX........X..........................X.........X.................
................X.......XXXXXXXXXXXXXXX.......X....................................................X.
X.......X.......X......XXXXXXXXXXXXXXXXX......X......................................................
................X.....XXXXXXXXXXXXXXXXXXX.....X......................................................
................X....XXXXXXXXXXXXXXXXXXXXX....X..X...................................................
................X.............XXX.............X..........X...........................................
................X.............XXX.............X......................X...............................
................X.............XXX.............X..........................X...........................
................X.............................X.......................X..............................
................X.............................X....................................X.................
................X.............................X......................................X...............
......X.........X.............................X......................................................
................XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX............................X.........................
.....................................................................................................
...............X...........................................X.........................................
.........................................X...........................................................
...................X.........................................................X.......................
.....................................X.............................................................X.
...........................X....................X....................................................
..........................................................X...........................X..............
.....................................................................................................
..X............X................X............................................X.......................
........................................X..X.........................................................
...........X......................................................................X..................
............X..........X...............................................................X.X...........
............................................................X........................................
...X......................................................................X..........................
.....X...............................................................................................
.....................................................................................................
.....................................................................................................
............................................X......................................X.................
*/
